#!/bin/bash

# deviceLinkingGuide.sh
# Complete guide for WhatsApp Bot device linking process

echo ""
echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
echo "â•‘   ğŸ“± WhatsApp Bot Device Linking - Complete Guide         â•‘"
echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo ""

echo "ğŸ¯ OVERVIEW"
echo "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"
echo "This guide will help you link your WhatsApp account to the bot"
echo "using a 6-digit pairing code (recommended) or QR code."
echo ""

echo "ğŸ“‹ PREREQUISITES"
echo "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"
echo "âœ“ WhatsApp installed on your phone"
echo "âœ“ .env file with BOT_MASTER_NUMBER set"
echo "âœ“ Node.js and npm installed"
echo "âœ“ Internet connection on both devices"
echo ""

echo "ğŸš€ STEP 1: Prepare Fresh Session"
echo "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"
echo ""
echo "Run this command to clean any old sessions:"
echo ""
echo "   npm run clean-sessions"
echo ""
echo "Or create a completely fresh session:"
echo ""
echo "   npm run fresh-start"
echo ""

echo "ğŸ“± STEP 2: Start the Bot"
echo "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"
echo ""
echo "Run the development server:"
echo ""
echo "   npm run dev"
echo ""
echo "You should see output like:"
echo ""
echo "   ğŸš€ WhatsApp Bot - Automatic Initialization"
echo "   ğŸ“± Master Account: 971505760056"
echo "   ğŸ¤– Bot Instance: Lion0"
echo "   ğŸ” Authentication Method: 6-Digit Code"
echo ""
echo "   â³ Creating WhatsApp client..."
echo "   âœ… WhatsApp client created successfully"
echo ""
echo "   ğŸ”„ Initializing device linking..."
echo ""

echo "ğŸ” STEP 3: Get 6-Digit Code"
echo "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"
echo ""
echo "The bot will request a 6-digit code from WhatsApp."
echo "You will see in terminal:"
echo ""
echo "   âœ… Pairing code generated successfully!"
echo "   ğŸ“± Master Number: 971505760056"
echo "   ğŸ” Your 6-digit code:"
echo ""
echo "   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”"
echo "   â”‚  123456                 â”‚"
echo "   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜"
echo ""
echo "âš ï¸  IMPORTANT:"
echo "   â€¢ Code expires in ~60 seconds"
echo "   â€¢ Note down the code immediately"
echo "   â€¢ Have your phone ready before starting"
echo ""

echo "ğŸ“± STEP 4: Link Device on Phone"
echo "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"
echo ""
echo "On your WhatsApp phone:"
echo ""
echo "   1. Open WhatsApp"
echo "   2. Go to: Settings â†’ Linked Devices"
echo "   3. Tap: Link a Device"
echo "   4. Select: Use 6-digit code"
echo "   5. Enter the code from terminal"
echo "   6. Wait for confirmation"
echo ""
echo "You'll see 'Device Linked' message on your phone"
echo ""

echo "âœ… STEP 5: Verify Connection"
echo "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"
echo ""
echo "Once linked, terminal will show:"
echo ""
echo "   âœ… AUTHENTICATION SUCCESSFUL!"
echo "   âœ… Device Status: LINKED & ACTIVE"
echo ""
echo "   â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
echo "   â•‘ ğŸ¤– LION0 BOT IS READY TO SERVE!      â•‘"
echo "   â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo ""
echo "   ğŸ“± Master Account: 971505760056"
echo "   âœ… Device Status: LINKED & ACTIVE"
echo "   âœ… Connection: AUTHENTICATED"
echo "   âœ… Session: PERSISTENT"
echo ""

echo "ğŸ”§ TROUBLESHOOTING"
echo "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"
echo ""
echo "Problem: Code not generating"
echo "Solution:"
echo "  1. npm run clean-sessions"
echo "  2. npm run dev"
echo ""

echo "Problem: Code expired before entering"
echo "Solution:"
echo "  1. Terminal should show new code automatically"
echo "  2. Use the latest code version"
echo "  3. You have 60 seconds to enter"
echo ""

echo "Problem: 'Authentication failure' error"
echo "Solution:"
echo "  1. Close WhatsApp on other devices (web, desktop)"
echo "  2. Run: npm run clean-sessions"
echo "  3. Run: npm run fresh-start"
echo "  4. Try linking again"
echo ""

echo "Problem: 'Browser already running' error"
echo "Solution:"
echo "  1. Close any Chrome/Edge processes"
echo "  2. Run: npm run clean-sessions"
echo "  3. Run: npm run dev"
echo ""

echo "ğŸ“Š UTILITIES AVAILABLE"
echo "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"
echo ""
echo "List all sessions:"
echo "  npm run list-sessions"
echo ""
echo "Clean master account session:"
echo "  npm run clean-sessions"
echo ""
echo "Create fresh session:"
echo "  npm run fresh-start"
echo ""
echo "Start bot (dev mode with auto-reload):"
echo "  npm run dev"
echo ""
echo "Start bot (production):"
echo "  npm start"
echo ""

echo "ğŸ’¡ TIPS FOR SUCCESS"
echo "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"
echo ""
echo "âœ“ Keep both windows open (terminal & phone)"
echo "âœ“ Phone must have internet connection"
echo "âœ“ Don't close WhatsApp while linking"
echo "âœ“ If code expires, wait for new one automatically"
echo "âœ“ Check .env file has correct master number"
echo "âœ“ First time only - session persists after that"
echo ""

echo "ğŸ“ NEXT STEPS"
echo "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"
echo ""
echo "1. Have your phone ready with WhatsApp open"
echo "2. Run: npm run fresh-start"
echo "3. Then: npm run dev"
echo "4. Wait for 6-digit code in terminal"
echo "5. Enter code on phone"
echo "6. Bot will start automatically once authenticated"
echo ""

echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "âœ… Ready to link! Type: npm run fresh-start"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo ""
